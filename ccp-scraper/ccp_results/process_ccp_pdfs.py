
import fitz
import json
import os
import sys
import re
from datetime import datetime

def extract_ccp_content(pdf_path, rule_info):
    """Extract content from a CCP PDF with rule-specific parsing"""
    try:
        # Check if file exists and has content
        if not os.path.exists(pdf_path):
            raise Exception(f"File not found: {pdf_path}")
        
        file_size = os.path.getsize(pdf_path)
        if file_size < 100:  # Less than 100 bytes is likely empty/corrupted
            raise Exception(f"File appears to be empty or corrupted (size: {file_size} bytes)")
        
        doc = fitz.open(pdf_path)
        
        # Check if document opened successfully
        if doc.is_closed:
            raise Exception("Document failed to open properly")
        
        if len(doc) == 0:
            doc.close()
            raise Exception("Document has no pages")
        
        # Extract metadata
        metadata = doc.metadata
        
        # Extract text content
        full_text = ""
        pages_content = []
        
        for page_num in range(len(doc)):
            try:
                page = doc[page_num]
                page_text = page.get_text()
                pages_content.append({
                    "page": page_num + 1,
                    "text": page_text.strip()
                })
                full_text += page_text + "\n"
            except Exception as page_error:
                print(f"Warning: Error reading page {page_num + 1}: {page_error}")
                pages_content.append({
                    "page": page_num + 1,
                    "text": f"[Error reading page: {page_error}]"
                })
        
        # CCP-specific content analysis
        ccp_analysis = analyze_ccp_content(full_text, rule_info)
        
        # Store page count before closing document
        page_count = len(doc)
        doc.close()
        
        return {
            "rule_info": rule_info,
            "file_info": {
                "file_path": pdf_path,
                "file_name": os.path.basename(pdf_path),
                "status": "success"
            },
            "metadata": {
                "title": metadata.get("title", ""),
                "author": metadata.get("author", ""),
                "subject": metadata.get("subject", ""),
                "creator": metadata.get("creator", ""),
                "producer": metadata.get("producer", ""),
                "creation_date": metadata.get("creationDate", ""),
                "modification_date": metadata.get("modDate", "")
            },
            "content": {
                "full_text": full_text.strip(),
                "page_count": page_count,
                "pages": pages_content,
                "character_count": len(full_text.strip()),
                "word_count": len(full_text.strip().split())
            },
            "ccp_analysis": ccp_analysis,
            "extracted_at": datetime.now().isoformat()
        }
        
    except Exception as e:
        return {
            "rule_info": rule_info,
            "file_info": {
                "file_path": pdf_path,
                "file_name": os.path.basename(pdf_path),
                "status": "error",
                "error": str(e)
            },
            "extracted_at": datetime.now().isoformat()
        }

def analyze_ccp_content(text, rule_info):
    """Analyze CCP content specifically for filing and procedural patterns"""
    analysis = {
        "section_number": rule_info.get("ruleNumber", ""),
        "section_title": rule_info.get("title", ""),
        "filing_relevance": rule_info.get("filingRelevance", {}),
        "procedural_requirements": [],
        "filing_procedures": [],
        "service_requirements": [],
        "deadlines_and_timing": [],
        "format_specifications": [],
        "cross_references": [],
        "key_provisions": []
    }
    
    # Extract procedural requirements
    proc_patterns = [
        r'shall\s+(?:be\s+)?(?:file[d]?|serve[d]?)\s+([^.]{10,100})',
        r'must\s+(?:be\s+)?(?:file[d]?|serve[d]?)\s+([^.]{10,100})',
        r'(?:filing|service)\s+(?:shall|must)\s+([^.]{10,100})',
        r'(?:document|paper|pleading)\s+(?:shall|must)\s+([^.]{10,100})'
    ]
    
    for pattern in proc_patterns:
        matches = re.findall(pattern, text, re.IGNORECASE)
        for match in matches:
            if len(match.strip()) > 15:
                analysis["procedural_requirements"].append(match.strip()[:200])
    
    # Extract timing requirements
    timing_patterns = [
        r'within\s+(\d+)\s+(calendar\s+days?|court\s+days?|business\s+days?|days?)',
        r'(\d+)\s+(calendar\s+days?|court\s+days?|business\s+days?)\s+(?:before|after|from)',
        r'(?:no\s+later\s+than|not\s+later\s+than)\s+([^.]{5,50})',
        r'(?:deadline|due\s+date|time\s+limit)\s+(?:is|shall\s+be)\s+([^.]{5,50})'
    ]
    
    for pattern in timing_patterns:
        matches = re.findall(pattern, text, re.IGNORECASE)
        for match in matches:
            if isinstance(match, tuple):
                timing_text = ' '.join(match)
            else:
                timing_text = match
            if len(timing_text.strip()) > 3:
                analysis["deadlines_and_timing"].append(timing_text.strip()[:150])
    
    # Extract cross-references
    ref_patterns = [
        r'(?:Section|Rule|Code)\s+(\d+\.?\d*(?:\.\d+)?)',
        r'Code\s+of\s+Civil\s+Procedure\s+[Ss]ection\s+(\d+\.?\d*)',
        r'California\s+Rules\s+of\s+Court\s+[Rr]ule\s+(\d+\.?\d*)',
    ]
    
    for pattern in ref_patterns:
        matches = re.findall(pattern, text, re.IGNORECASE)
        for match in matches:
            if match not in analysis["cross_references"]:
                analysis["cross_references"].append(match)
    
    # Extract key provisions (paragraphs with filing-related content)
    paragraphs = text.split('\n\n')
    filing_terms = ['filing', 'service', 'pleading', 'summons', 'complaint', 'procedure', 'deadline', 'format']
    
    for para in paragraphs:
        para = para.strip()
        if len(para) > 50 and any(term in para.lower() for term in filing_terms):
            analysis["key_provisions"].append(para[:300])
            if len(analysis["key_provisions"]) >= 5:  # Limit to top 5
                break
    
    return analysis

def main():
    pdf_paths = ["ccp_pdfs/ccp_section_12_2025-06-21_0.pdf","ccp_pdfs/ccp_section_34_2025-06-21_2.pdf","ccp_pdfs/ccp_section_286_2025-06-21_3.pdf","ccp_pdfs/ccp_section_394_2025-06-21_4.pdf","ccp_pdfs/ccp_section_401_2025-06-21_5.pdf","ccp_pdfs/ccp_section_410.10_2025-06-21_6.pdf","ccp_pdfs/ccp_section_410.42_2025-06-21_7.pdf","ccp_pdfs/ccp_section_410.70_2025-06-21_8.pdf","ccp_pdfs/ccp_section_411.35_2025-06-21_9.pdf","ccp_pdfs/ccp_section_412.30_2025-06-21_11.pdf","ccp_pdfs/ccp_section_413.40_2025-06-21_12.pdf","ccp_pdfs/ccp_section_414.10_2025-06-21_13.pdf","ccp_pdfs/ccp_section_415.95_2025-06-21_14.pdf","ccp_pdfs/ccp_section_416.90_2025-06-21_15.pdf","ccp_pdfs/ccp_section_417.40_2025-06-21_16.pdf","ccp_pdfs/ccp_section_418.11_2025-06-21_17.pdf","ccp_pdfs/ccp_section_437_2025-06-21_18.pdf","ccp_pdfs/ccp_section_483.020_2025-06-21_19.pdf","ccp_pdfs/ccp_section_660_2025-06-21_20.pdf","ccp_pdfs/ccp_section_1062.34_2025-06-21_21.pdf","ccp_pdfs/ccp_section_1250.430_2025-06-21_22.pdf","ccp_pdfs/ccp_section_1291.2_2025-06-21_23.pdf","ccp_pdfs/ccp_section_2025.010_2025-06-21_24.pdf","ccp_pdfs/ccp_section_2025.480_2025-06-21_25.pdf","ccp_pdfs/ccp_section_2033.740_2025-06-21_26.pdf","ccp_pdfs/ccp_section_2034.010_2025-06-21_27.pdf","ccp_pdfs/ccp_section_2034.630_2025-06-21_28.pdf","ccp_pdfs/ccp_section_2035.060_2025-06-21_29.pdf","ccp_pdfs/ccp_section_437c_2025-06-21_30.pdf","ccp_pdfs/ccp_section_438_2025-06-21_31.pdf","ccp_pdfs/ccp_section_1005_2025-06-21_32.pdf","ccp_pdfs/ccp_section_1010_2025-06-21_33.pdf","ccp_pdfs/ccp_section_1010.6_2025-06-21_34.pdf","ccp_pdfs/ccp_section_1011_2025-06-21_35.pdf","ccp_pdfs/ccp_section_1012_2025-06-21_36.pdf","ccp_pdfs/ccp_section_1013_2025-06-21_37.pdf","ccp_pdfs/ccp_section_1019.5_2025-06-21_38.pdf","ccp_pdfs/ccp_section_1014_2025-06-21_39.pdf","ccp_pdfs/ccp_section_473_2025-06-21_40.pdf","ccp_pdfs/ccp_section_128.7_2025-06-21_41.pdf","ccp_pdfs/ccp_section_170_2025-06-21_42.pdf","ccp_pdfs/ccp_section_170.1_2025-06-21_43.pdf","ccp_pdfs/ccp_section_170.3_2025-06-21_44.pdf","ccp_pdfs/ccp_section_170.6_2025-06-21_45.pdf","ccp_pdfs/ccp_section_594_2025-06-21_46.pdf","ccp_pdfs/ccp_section_1003_2025-06-21_47.pdf","ccp_pdfs/ccp_section_1006_2025-06-21_48.pdf","ccp_pdfs/ccp_section_583.210_2025-06-21_49.pdf","ccp_pdfs/ccp_section_583.220_2025-06-21_50.pdf","ccp_pdfs/ccp_section_583.230_2025-06-21_51.pdf","ccp_pdfs/ccp_section_583.250_2025-06-21_52.pdf","ccp_pdfs/ccp_section_12a_2025-06-21_53.pdf","ccp_pdfs/ccp_section_12c_2025-06-21_54.pdf","ccp_pdfs/ccp_section_2024.020_2025-06-21_55.pdf","ccp_pdfs/ccp_section_1287_2025-06-21_56.pdf","ccp_pdfs/ccp_section_1288_2025-06-21_57.pdf","ccp_pdfs/ccp_section_1290_2025-06-21_58.pdf","ccp_pdfs/ccp_section_1294_2025-06-21_59.pdf","ccp_pdfs/ccp_section_1086_2025-06-21_60.pdf","ccp_pdfs/ccp_section_1094.5_2025-06-21_61.pdf","ccp_pdfs/ccp_section_1094.6_2025-06-21_62.pdf","ccp_pdfs/ccp_section_664_2025-06-21_63.pdf","ccp_pdfs/ccp_section_664.5_2025-06-21_64.pdf","ccp_pdfs/ccp_section_664.6_2025-06-21_65.pdf","ccp_pdfs/ccp_section_667_2025-06-21_66.pdf","ccp_pdfs/ccp_section_670_2025-06-21_67.pdf","ccp_pdfs/ccp_section_430.10_2025-06-21_68.pdf","ccp_pdfs/ccp_section_430.20_2025-06-21_69.pdf","ccp_pdfs/ccp_section_430.30_2025-06-21_70.pdf","ccp_pdfs/ccp_section_430.40_2025-06-21_71.pdf","ccp_pdfs/ccp_section_430.41_2025-06-21_72.pdf","ccp_pdfs/ccp_section_431.30_2025-06-21_73.pdf","ccp_pdfs/ccp_section_431.40_2025-06-21_74.pdf","ccp_pdfs/ccp_section_472_2025-06-21_75.pdf","ccp_pdfs/ccp_section_472a_2025-06-21_76.pdf","ccp_pdfs/ccp_section_472c_2025-06-21_77.pdf","ccp_pdfs/ccp_section_472d_2025-06-21_78.pdf","ccp_pdfs/ccp_section_435_2025-06-21_79.pdf","ccp_pdfs/ccp_section_436_2025-06-21_80.pdf","ccp_pdfs/ccp_section_425.10_2025-06-21_81.pdf","ccp_pdfs/ccp_section_425.11_2025-06-21_82.pdf","ccp_pdfs/ccp_section_425.12_2025-06-21_83.pdf","ccp_pdfs/ccp_section_425.13_2025-06-21_84.pdf","ccp_pdfs/ccp_section_426.10_2025-06-21_85.pdf","ccp_pdfs/ccp_section_426.30_2025-06-21_86.pdf","ccp_pdfs/ccp_section_426.50_2025-06-21_87.pdf","ccp_pdfs/ccp_section_367_2025-06-21_88.pdf","ccp_pdfs/ccp_section_2030.300_2025-06-21_89.pdf","ccp_pdfs/ccp_section_2031.310_2025-06-21_90.pdf","ccp_pdfs/ccp_section_527_2025-06-21_91.pdf","ccp_pdfs/ccp_section_2016.010_2025-06-21_92.pdf","ccp_pdfs/ccp_section_2023.010_2025-06-21_93.pdf","ccp_pdfs/ccp_section_2030.010_2025-06-21_94.pdf","ccp_pdfs/ccp_section_2031.010_2025-06-21_95.pdf","ccp_pdfs/ccp_section_2033.010_2025-06-21_96.pdf","ccp_pdfs/ccp_section_659_2025-06-21_97.pdf","ccp_pdfs/ccp_section_659a_2025-06-21_98.pdf","ccp_pdfs/ccp_section_663_2025-06-21_99.pdf","ccp_pdfs/ccp_section_1013a_2025-06-21_100.pdf","ccp_pdfs/ccp_section_1010.5_2025-06-21_101.pdf","ccp_pdfs/ccp_section_36_2025-06-21_102.pdf","ccp_pdfs/ccp_section_1048_2025-06-21_103.pdf"]
    rule_data = [{"ruleNumber":"12","title":"12\nCHAPTER 12. Actions for Restitution for or Replacement of Certain Motor Vehicles","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=12","filename":"ccp_section_12_2025-06-21_0.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"34","title":"34\nTITLE 1. OF THE FORM OF CIVIL ACTIONS","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=34","filename":"ccp_section_34_2025-06-21_2.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"286","title":"286\nTITLE 1. ORGANIZATION AND JURISDICTION","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=286","filename":"ccp_section_286_2025-06-21_3.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"394","title":"394\nARTICLE 7. Enforceability of Decree","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=394","filename":"ccp_section_394_2025-06-21_4.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"401","title":"401\nARTICLE 8. Costs","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=401","filename":"ccp_section_401_2025-06-21_5.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"410.10","title":"410.10\nARTICLE 2. Forum","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=410.10","filename":"ccp_section_410.10_2025-06-21_6.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"410.42","title":"410.42\nARTICLE 3. Jurisdiction in Action","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=410.42","filename":"ccp_section_410.42_2025-06-21_7.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"410.70","title":"410.70\nARTICLE 1. Jurisdiction","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=410.70","filename":"ccp_section_410.70_2025-06-21_8.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"411.35","title":"411.35\nCHAPTER 3. Summons","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=411.35","filename":"ccp_section_411.35_2025-06-21_9.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"412.30","title":"412.30\nCHAPTER 4. Service of Summons","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=412.30","filename":"ccp_section_412.30_2025-06-21_11.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"413.40","title":"413.40\nARTICLE 2. Persons Who May Serve Summons","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=413.40","filename":"ccp_section_413.40_2025-06-21_12.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"414.10","title":"414.10\nARTICLE 3. Manner of Service of Summons","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=414.10","filename":"ccp_section_414.10_2025-06-21_13.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"415.95","title":"415.95\nARTICLE 4. Persons Upon Whom Summons May Be Served","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=415.95","filename":"ccp_section_415.95_2025-06-21_14.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"416.90","title":"416.90\nARTICLE 5. Proof of Service","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=416.90","filename":"ccp_section_416.90_2025-06-21_15.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"417.40","title":"417.40\nARTICLE 1. General","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=417.40","filename":"ccp_section_417.40_2025-06-21_16.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"418.11","title":"418.11\nCHAPTER 1. Jurisdiction and Forum","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=418.11","filename":"ccp_section_418.11_2025-06-21_17.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"437","title":"437\nCHAPTER 5. Summary Judgments and Motions for Judgment on the Pleadings","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=437","filename":"ccp_section_437_2025-06-21_18.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"483.020","title":"483.020\nCHAPTER 4. Noticed Hearing Procedure for Obtaining Writ of Attachment","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=483.020","filename":"ccp_section_483.020_2025-06-21_19.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"660","title":"660\nCHAPTER 7. Undertakings","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=660","filename":"ccp_section_660_2025-06-21_20.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1062.34","title":"1062.34\nTITLE 1. OF THE FORM OF CIVIL ACTIONS","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1062.34","filename":"ccp_section_1062.34_2025-06-21_21.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1250.430","title":"1250.430\nARTICLE 1. Jurisdiction and Venue","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1250.430","filename":"ccp_section_1250.430_2025-06-21_22.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1291.2","title":"1291.2\nARTICLE 2. Venue, Jurisdiction and Costs","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1291.2","filename":"ccp_section_1291.2_2025-06-21_23.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2025.010","title":"2025.010\nARTICLE 2. Deposition Notice","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2025.010","filename":"ccp_section_2025.010_2025-06-21_24.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2025.480","title":"2025.480\nARTICLE 5. Transcript or Recording","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2025.480","filename":"ccp_section_2025.480_2025-06-21_25.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2033.740","title":"2033.740\nCHAPTER 18. Simultaneous Exchange of Expert Witness Information","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2033.740","filename":"ccp_section_2033.740_2025-06-21_26.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2034.010","title":"2034.010\nARTICLE 2. Demand for Exchange of Expert Witness Information","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2034.010","filename":"ccp_section_2034.010_2025-06-21_27.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2034.630","title":"2034.630\nARTICLE 5. Motion To Submit Tardy Expert Witness Information","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2034.630","filename":"ccp_section_2034.630_2025-06-21_28.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2035.060","title":"2035.060\nCHAPTER 20. Perpetuation of Testimony or Preservation of Information Pending","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2035.060","filename":"ccp_section_2035.060_2025-06-21_29.pdf","source":"toc_pdf_text_pattern","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"437c","title":"CCP Section 437c - Summary Judgment Motions","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=437c","filename":"ccp_section_437c_2025-06-21_30.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"438","title":"CCP Section 438 - Summary Judgment Procedure","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=438","filename":"ccp_section_438_2025-06-21_31.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1005","title":"CCP Section 1005 - Motion Deadlines and Notice Requirements (16 court days notice, 9 days for opposition, 5 days for reply)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1005","filename":"ccp_section_1005_2025-06-21_32.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1010","title":"CCP Section 1010 - Service Methods and Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1010","filename":"ccp_section_1010_2025-06-21_33.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1010.6","title":"CCP Section 1010.6 - Electronic Service Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1010.6","filename":"ccp_section_1010.6_2025-06-21_34.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1011","title":"CCP Section 1011 - Personal Service Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1011","filename":"ccp_section_1011_2025-06-21_35.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1012","title":"CCP Section 1012 - Service by Mail Timing and Extensions","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1012","filename":"ccp_section_1012_2025-06-21_36.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1013","title":"CCP Section 1013 - Time Extensions for Mail Service (+5 days in CA, +10 out of state, +2 court days for fax/overnight)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1013","filename":"ccp_section_1013_2025-06-21_37.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1019.5","title":"CCP Section 1019.5 - Notice of Court Orders and Decisions","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1019.5","filename":"ccp_section_1019.5_2025-06-21_38.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1014","title":"CCP Section 1014 - Proof of Service Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1014","filename":"ccp_section_1014_2025-06-21_39.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"473","title":"CCP Section 473 - Relief from Default Judgments and Procedural Errors","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=473","filename":"ccp_section_473_2025-06-21_40.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"128.7","title":"CCP Section 128.7 - Sanctions for Frivolous Filings","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=128.7","filename":"ccp_section_128.7_2025-06-21_41.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"170","title":"CCP Section 170 - Judge Disqualification Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=170","filename":"ccp_section_170_2025-06-21_42.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"170.1","title":"CCP Section 170.1 - Judge Disqualification Grounds","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=170.1","filename":"ccp_section_170.1_2025-06-21_43.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"170.3","title":"CCP Section 170.3 - Judge Disqualification Procedure","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=170.3","filename":"ccp_section_170.3_2025-06-21_44.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"170.6","title":"CCP Section 170.6 - Peremptory Challenge to Judge","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=170.6","filename":"ccp_section_170.6_2025-06-21_45.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"594","title":"CCP Section 594 - Notice of Trial Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=594","filename":"ccp_section_594_2025-06-21_46.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1003","title":"CCP Section 1003 - Ex Parte Applications","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1003","filename":"ccp_section_1003_2025-06-21_47.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1006","title":"CCP Section 1006 - Extensions of Time","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1006","filename":"ccp_section_1006_2025-06-21_48.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"583.210","title":"CCP Section 583.210 - Dismissal for Delay in Prosecution (2-year rule)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=583.210","filename":"ccp_section_583.210_2025-06-21_49.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"583.220","title":"CCP Section 583.220 - Dismissal for Delay - Service Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=583.220","filename":"ccp_section_583.220_2025-06-21_50.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"583.230","title":"CCP Section 583.230 - Dismissal for Delay - Bringing to Trial","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=583.230","filename":"ccp_section_583.230_2025-06-21_51.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"583.250","title":"CCP Section 583.250 - Dismissal for Delay - New Trial","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=583.250","filename":"ccp_section_583.250_2025-06-21_52.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"12a","title":"CCP Section 12a - Time Computation for Service","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=12a","filename":"ccp_section_12a_2025-06-21_53.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"12c","title":"CCP Section 12c - Time Computation for Court Days","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=12c","filename":"ccp_section_12c_2025-06-21_54.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2024.020","title":"CCP Section 2024.020 - Discovery Cutoff Deadlines (30 days before trial)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2024.020","filename":"ccp_section_2024.020_2025-06-21_55.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1287","title":"CCP Section 1287 - Arbitration Petition Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1287","filename":"ccp_section_1287_2025-06-21_56.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1288","title":"CCP Section 1288 - Arbitration Award Confirmation","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1288","filename":"ccp_section_1288_2025-06-21_57.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1290","title":"CCP Section 1290 - Arbitration Award Correction","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1290","filename":"ccp_section_1290_2025-06-21_58.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1294","title":"CCP Section 1294 - Arbitration Award Vacation","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1294","filename":"ccp_section_1294_2025-06-21_59.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1086","title":"CCP Section 1086 - Writ of Mandate Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1086","filename":"ccp_section_1086_2025-06-21_60.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1094.5","title":"CCP Section 1094.5 - Administrative Mandate Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1094.5","filename":"ccp_section_1094.5_2025-06-21_61.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1094.6","title":"CCP Section 1094.6 - Administrative Record Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1094.6","filename":"ccp_section_1094.6_2025-06-21_62.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"664","title":"CCP Section 664 - Entry of Judgment Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=664","filename":"ccp_section_664_2025-06-21_63.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"664.5","title":"CCP Section 664.5 - Entry of Judgment on Jury Verdict","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=664.5","filename":"ccp_section_664.5_2025-06-21_64.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"664.6","title":"CCP Section 664.6 - Settlement Agreement Enforcement","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=664.6","filename":"ccp_section_664.6_2025-06-21_65.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"667","title":"CCP Section 667 - Default Judgment Entry","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=667","filename":"ccp_section_667_2025-06-21_66.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"670","title":"CCP Section 670 - Judgment Roll Contents","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=670","filename":"ccp_section_670_2025-06-21_67.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"430.10","title":"CCP Section 430.10 - Demurrer Grounds and Requirements (Motion to Dismiss)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=430.10","filename":"ccp_section_430.10_2025-06-21_68.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"430.20","title":"CCP Section 430.20 - Demurrer Procedure and Format Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=430.20","filename":"ccp_section_430.20_2025-06-21_69.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"430.30","title":"CCP Section 430.30 - Time for Filing Demurrer","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=430.30","filename":"ccp_section_430.30_2025-06-21_70.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"430.40","title":"CCP Section 430.40 - Demurrer to Answer Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=430.40","filename":"ccp_section_430.40_2025-06-21_71.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"430.41","title":"CCP Section 430.41 - Meet and Confer Requirements for Demurrer","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=430.41","filename":"ccp_section_430.41_2025-06-21_72.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"431.30","title":"CCP Section 431.30 - Answer Format and Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=431.30","filename":"ccp_section_431.30_2025-06-21_73.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"431.40","title":"CCP Section 431.40 - Cross-Complaint Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=431.40","filename":"ccp_section_431.40_2025-06-21_74.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"472","title":"CCP Section 472 - Amendment of Pleadings","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=472","filename":"ccp_section_472_2025-06-21_75.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"472a","title":"CCP Section 472a - Leave to Amend Pleadings","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=472a","filename":"ccp_section_472a_2025-06-21_76.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"472c","title":"CCP Section 472c - Amendment to Conform to Proof","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=472c","filename":"ccp_section_472c_2025-06-21_77.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"472d","title":"CCP Section 472d - Time for Amendment After Demurrer","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=472d","filename":"ccp_section_472d_2025-06-21_78.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"435","title":"CCP Section 435 - Motion to Strike Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=435","filename":"ccp_section_435_2025-06-21_79.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"436","title":"CCP Section 436 - Grounds for Motion to Strike","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=436","filename":"ccp_section_436_2025-06-21_80.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"425.10","title":"CCP Section 425.10 - Complaint Format and Content Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=425.10","filename":"ccp_section_425.10_2025-06-21_81.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"425.11","title":"CCP Section 425.11 - Complaint Caption Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=425.11","filename":"ccp_section_425.11_2025-06-21_82.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"425.12","title":"CCP Section 425.12 - Verification Requirements for Pleadings","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=425.12","filename":"ccp_section_425.12_2025-06-21_83.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"425.13","title":"CCP Section 425.13 - Doe Defendants in Complaints","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=425.13","filename":"ccp_section_425.13_2025-06-21_84.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"426.10","title":"CCP Section 426.10 - Compulsory Cross-Complaints","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=426.10","filename":"ccp_section_426.10_2025-06-21_85.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"426.30","title":"CCP Section 426.30 - Permissive Cross-Complaints","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=426.30","filename":"ccp_section_426.30_2025-06-21_86.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"426.50","title":"CCP Section 426.50 - Cross-Complaint Filing Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=426.50","filename":"ccp_section_426.50_2025-06-21_87.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"367","title":"CCP Section 367 - Capacity to Sue and Document Requirements","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=367","filename":"ccp_section_367_2025-06-21_88.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2030.300","title":"CCP Section 2030.300 - Motion to Compel Interrogatory Responses (45-day deadline)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2030.300","filename":"ccp_section_2030.300_2025-06-21_89.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2031.310","title":"CCP Section 2031.310 - Motion to Compel Document Production","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2031.310","filename":"ccp_section_2031.310_2025-06-21_90.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"527","title":"CCP Section 527 - Temporary Restraining Orders","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=527","filename":"ccp_section_527_2025-06-21_91.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2016.010","title":"CCP Section 2016.010 - Discovery Act General Provisions","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2016.010","filename":"ccp_section_2016.010_2025-06-21_92.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2023.010","title":"CCP Section 2023.010 - Discovery Sanctions","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2023.010","filename":"ccp_section_2023.010_2025-06-21_93.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2030.010","title":"CCP Section 2030.010 - Interrogatory Procedures","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2030.010","filename":"ccp_section_2030.010_2025-06-21_94.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2031.010","title":"CCP Section 2031.010 - Document Production","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2031.010","filename":"ccp_section_2031.010_2025-06-21_95.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"2033.010","title":"CCP Section 2033.010 - Requests for Admission","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=2033.010","filename":"ccp_section_2033.010_2025-06-21_96.pdf","source":"manual_critical_addition","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"659","title":"CCP Section 659 - Motion for New Trial (WHEN: 30-day post-trial deadline)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=659","filename":"ccp_section_659_2025-06-21_97.pdf","source":"critical_filing_question_WHEN","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"659a","title":"CCP Section 659a - New Trial Motion Requirements (WHAT: Required format and contents for new trial motion)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=659a","filename":"ccp_section_659a_2025-06-21_98.pdf","source":"critical_filing_question_WHAT","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"663","title":"CCP Section 663 - Motion for Judgment Notwithstanding Verdict (WHEN/WHAT: Post-trial JNOV filing requirements)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=663","filename":"ccp_section_663_2025-06-21_99.pdf","source":"critical_filing_question_WHEN_WHAT","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1013a","title":"CCP Section 1013a - Electronic Service Time Extensions (WHEN: Additional time for electronic service)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1013a","filename":"ccp_section_1013a_2025-06-21_100.pdf","source":"critical_filing_question_WHEN","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1010.5","title":"CCP Section 1010.5 - Overnight Delivery Service (HOW: Overnight delivery filing procedures)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1010.5","filename":"ccp_section_1010.5_2025-06-21_101.pdf","source":"critical_filing_question_HOW","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"36","title":"CCP Section 36 - Calendar Preferences (WHERE/WHEN: Court scheduling affecting filing deadlines)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=36","filename":"ccp_section_36_2025-06-21_102.pdf","source":"critical_filing_question_WHERE_WHEN","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"},{"ruleNumber":"1048","title":"CCP Section 1048 - Consolidation of Actions (HOW: Affects filing procedures in multiple cases)","url":"https://leginfo.legislature.ca.gov/faces/codes_displaySection.xhtml?lawCode=CCP&sectionNum=1048","filename":"ccp_section_1048_2025-06-21_103.pdf","source":"critical_filing_question_HOW","filingRelevance":{"score":8,"isRelevant":True,"source":"pre_filtered"},"contentType":"pdf"}]
    
    # Create mapping of PDF paths to rule data
    path_to_rule = {}
    for i, pdf_path in enumerate(pdf_paths):
        if i < len(rule_data):
            path_to_rule[pdf_path] = rule_data[i]
        else:
            path_to_rule[pdf_path] = {"ruleNumber": "Unknown", "title": "Unknown"}
    
    results = []
    
    print(f"Processing {len(pdf_paths)} CCP PDF files...")
    
    for i, pdf_path in enumerate(pdf_paths, 1):
        rule_info = path_to_rule.get(pdf_path, {})
        section_num = rule_info.get("ruleNumber", "Unknown")
        
        print(f"\nProcessing {i}/{len(pdf_paths)}: CCP Section {section_num}")
        print(f"File: {os.path.basename(pdf_path)}")
        
        if not os.path.exists(pdf_path):
            print(f"❌ File not found: {pdf_path}")
            results.append({
                "rule_info": rule_info,
                "file_info": {
                    "file_path": pdf_path,
                    "status": "error",
                    "error": "File not found"
                }
            })
            continue
        
        result = extract_ccp_content(pdf_path, rule_info)
        results.append(result)
        
        if result["file_info"]["status"] == "success":
            content = result["content"]
            analysis = result["ccp_analysis"]
            print(f"✅ Success: {content['page_count']} pages, {content['word_count']} words")
            print(f"   📋 Procedural requirements: {len(analysis['procedural_requirements'])}")
            print(f"   ⏰ Timing requirements: {len(analysis['deadlines_and_timing'])}")
            print(f"   🔗 Cross-references: {len(analysis['cross_references'])}")
            print(f"   📄 Key provisions: {len(analysis['key_provisions'])}")
        else:
            print(f"❌ Error: {result['file_info'].get('error', 'Unknown error')}")
    
    # Save results
    output_path = "ccp_results/ccp_pymupdf_results.json"
    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(results, f, indent=2, ensure_ascii=False)
    
    print(f"\n💾 CCP analysis results saved to: {output_path}")
    print(f"✅ Processed {len(results)} CCP section documents")
    
    # Generate summary
    successful = [r for r in results if r.get('file_info', {}).get('status') == 'success']
    total_procedures = sum(len(r.get('ccp_analysis', {}).get('procedural_requirements', [])) for r in successful)
    total_timing = sum(len(r.get('ccp_analysis', {}).get('deadlines_and_timing', [])) for r in successful)
    
    print(f"\n📊 CCP Analysis Summary:")
    print(f"   • Successful extractions: {len(successful)}/{len(results)} documents")
    print(f"   • Total procedural requirements: {total_procedures}")
    print(f"   • Total timing requirements: {total_timing}")

if __name__ == "__main__":
    main()
